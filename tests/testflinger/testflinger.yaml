job_queue: $JOB_QUEUE

provision_data:
  distro: noble

test_data:
  # Copy test scripts to the Testflinger Agent
  attachments:
    - local: "agent.sh"
      agent: "agent.sh"

  # Run commands on the Testflinger Agent
  test_cmds: |
    #!/bin/bash -eu

    # These vars are replaced by envsubst in the caller. Either in run.sh or the Github workflow.
    export SNAP_NAME=$SNAP_NAME
    export SNAP_CHANNEL=$SNAP_CHANNEL
    export EXPECTED_ENGINE=$EXPECTED_ENGINE
    export EXPECTED_TPS=$EXPECTED_TPS
    export INSTALL_NVIDIA_DRIVERS=$INSTALL_NVIDIA_DRIVERS
    export NVIDIA_DRIVERS_VERSION=$NVIDIA_DRIVERS_VERSION
    export SELECT_ENGINE=$SELECT_ENGINE

    exec attachments/test/agent.sh
